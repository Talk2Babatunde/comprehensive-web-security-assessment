# Exploitation Steps — Technical Playbook

This file documents clear, repeatable steps used to validate each vulnerability during the assessment. Each step is written as a concise Proof-of-Concept (PoC) that demonstrates exploitability without causing harm. Use these steps only in controlled lab environments.

---

## Privilege Escalation — Role Manipulation (PoC)
1. Log in as a normal user.
2. Intercept the login or profile update request with Burp Suite (Proxy → Intercept).
3. Locate the parameter `user_role` or similar in the request body.
4. Modify `user_role=user` → `user_role=admin`.
5. Forward the altered request and refresh the UI.
6. Validate elevated privileges by visiting `/admin` pages or checking admin-only functionality.
7. Capture request/response and record the exact changed parameter for reporting.

**Notes:** Demonstrates lack of server-side role validation. Collect screenshots and server response headers for evidence.

---

## CSRF — Forced State Change (PoC)
1. Identify a state-changing POST endpoint (e.g., `/profile/update` or `/update_password`).
2. Build a simple HTML form that posts to that endpoint with critical fields populated:
   ```html
   <form action="https://target/update_password" method="POST">
     <input type="hidden" name="password" value="P@wned123">
     <input type="submit" value="Submit">
   </form>
Host the page locally and visit while authenticated to the target (lab user).

Observe whether the action executes without valid CSRF tokens.

Notes: Capture request logs and steps to reproduce. Do not use on real accounts.

IDOR — Direct Object Access (PoC)

Identify URL patterns that accept identifiers: /invoice?id=100.

Change the id value to another known or sequential value.

Observe whether the server returns another user’s data.

Verify lack of ownership/authorization checks in server responses.

Notes: Use test accounts only. Log the accessible endpoints and sample IDs that succeed.

Directory Listing — Sensitive Files Exposure (PoC)

Visit suspected directories: /uploads/, /backup/, /logs/.

If listing is enabled, enumerate filenames and download a safe sample (e.g., .bak).

Inspect for credentials, API keys, or sensitive paths.

Notes: Document filenames, paths, and explain how exposed files could be chained into further attacks.

SSTI — Template Injection (PoC)

Find an input rendered without sanitization (e.g., profile description).

Inject a simple expression supported by the templating engine ({{7*7}}, #{1+1}, etc.).

If evaluated, escalate to read-only commands, then carefully attempt controlled payloads in the lab environment to demonstrate impact.

Notes: SSTI can lead to remote code execution. Capture rendered output and context.

General Evidence Collection

Save Burp requests/responses as .xml or screenshots.

Export relevant Wazuh logs and YARA output snippets.

Record exact commands, timestamps, and test accounts used.